{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% translate 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:database_tables' %}">Database Tables</a>
&rsaquo; <a href="{% url 'admin:table_data' table_name %}">{{ table_name }}</a>
&rsaquo; Edit Row
</div>
{% endblock %}

{% block content %}
<h1>Edit Row: {{ table_name }}</h1>

{% if error_message %}
<div class="errornote">
    <strong>Error:</strong> {{ error_message }}
</div>
{% endif %}

<div style="margin: 20px 0;">
    <a href="{% url 'admin:table_data' table_name %}" class="button">← Back to Table</a>
    <a href="{% url 'admin:database_tables' %}" class="button" style="margin-left: 10px;">← All Tables</a>
</div>

{% if data %}
<form method="post" style="margin-top: 20px;">
    {% csrf_token %}
    
    {% for pk in primary_keys %}
        <input type="hidden" name="pk_{{ pk }}" value="{{ data|get_item:pk }}">
    {% endfor %}
    
    <div class="module">
        <table style="width: 100%; border-collapse: collapse;">
            <tbody>
                {% for col in columns %}
                <tr>
                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; background-color: #f5f5f5; width: 200px;">
                        {{ col.name }}
                        {% if col.name in primary_keys %}
                            <span style="color: #999; font-size: 11px;">(Primary Key - Read Only)</span>
                        {% endif %}
                    </th>
                    <td style="padding: 12px; border: 1px solid #ddd;">
                        {% if col.name in primary_keys %}
                            <input type="text" value="{{ data|get_item:col.name }}" readonly style="width: 100%; padding: 5px; background-color: #f5f5f5;">
                        {% elif col.type == 'boolean' or col.type == 'boolean' %}
                            <select name="{{ col.name }}" style="width: 100%; padding: 5px;">
                                <option value="true" {% if data|get_item:col.name %}selected{% endif %}>True</option>
                                <option value="false" {% if not data|get_item:col.name %}selected{% endif %}>False</option>
                            </select>
                        {% elif col.type|slice:":4" == "text" or col.type == "character varying" %}
                            <textarea name="{{ col.name }}" style="width: 100%; padding: 5px; min-height: 60px;">{{ data|get_item:col.name|default:"" }}</textarea>
                        {% else %}
                            <input type="text" name="{{ col.name }}" value="{{ data|get_item:col.name|default:"" }}" style="width: 100%; padding: 5px;">
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div style="margin-top: 20px;">
        <input type="submit" value="Save" class="default button">
        <a href="{% url 'admin:table_data' table_name %}" class="button" style="margin-left: 10px;">Cancel</a>
    </div>
</form>
{% else %}
<div class="info" style="margin-top: 20px;">
    <p>No data found.</p>
</div>
{% endif %}

{% endblock %}

